

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pynfft - The core NFFT functionalities &mdash; pyNFFT 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="pyNFFT 1.0.0 documentation" href="../index.html" />
    <link rel="up" title="API Reference" href="../api.html" />
    <link rel="next" title="pynfft.util - Utility functions" href="util.html" />
    <link rel="prev" title="API Reference" href="../api.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="util.html" title="pynfft.util - Utility functions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../api.html" title="API Reference"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">pyNFFT 1.0.0 documentation</a> &raquo;</li>
          <li><a href="../api.html" accesskey="U">API Reference</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-pynfft">
<span id="pynfft-the-core-nfft-functionalities"></span><h1><tt class="docutils literal"><span class="pre">pynfft</span></tt> - The core NFFT functionalities<a class="headerlink" href="#module-pynfft" title="Permalink to this headline">¶</a></h1>
<div class="section" id="nfft-class">
<h2>NFFT Class<a class="headerlink" href="#nfft-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pynfft.NFFT">
<em class="property">class </em><tt class="descclassname">pynfft.</tt><tt class="descname">NFFT</tt><big>(</big><em>N</em>, <em>M</em>, <em>n=None</em>, <em>m=12</em>, <em>x=None</em>, <em>f=None</em>, <em>f_hat=None</em>, <em>flags=None</em><big>)</big><a class="headerlink" href="#pynfft.NFFT" title="Permalink to this definition">¶</a></dt>
<dd><p>NFFT is a class for computing the multivariate Non-uniform Discrete
Fourier (NDFT) transform using the NFFT library. The interface is
designed to be somewhat pythonic, while retaining the features and
naming of the C code internals. The computation of the NFFT is achieved
in 3 steps: instantiation, precomputation and execution.</p>
<p>On instantiation, sanity checks on the size parameters and computation
flags are performed prior to initialization of the internal plan.
External data arrays may be provided, otherwise internal Numpy arrays
will be used. Any incompatibilities detected in the parameters will raise
a <tt class="docutils literal"><span class="pre">ValueError</span></tt> exception.</p>
<p>The nodes must be initialized prior to precomputing the operator with the
<a class="reference internal" href="#pynfft.NFFT.precompute" title="pynfft.NFFT.precompute"><tt class="xref py py-meth docutils literal"><span class="pre">pynfft.NFFT.precompute()</span></tt></a> method.</p>
<p>The forward and adjoint NFFT operation may be performed by calling the
<a class="reference internal" href="#pynfft.NFFT.trafo" title="pynfft.NFFT.trafo"><tt class="xref py py-meth docutils literal"><span class="pre">pynfft.NFFT.trafo()</span></tt></a> or <a class="reference internal" href="#pynfft.NFFT.adjoint" title="pynfft.NFFT.adjoint"><tt class="xref py py-meth docutils literal"><span class="pre">pynfft.NFFT.adjoint()</span></tt></a>
methods. The NDFT may also be computed by calling the
<a class="reference internal" href="#pynfft.NFFT.trafo_direct" title="pynfft.NFFT.trafo_direct"><tt class="xref py py-meth docutils literal"><span class="pre">pynfft.NFFT.trafo_direct()</span></tt></a> or
<a class="reference internal" href="#pynfft.NFFT.adjoint_direct" title="pynfft.NFFT.adjoint_direct"><tt class="xref py py-meth docutils literal"><span class="pre">pynfft.NFFT.adjoint_direct()</span></tt></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>N</strong> (<em>int, tuple of int</em>) &#8211; multi-bandwith size.</li>
<li><strong>M</strong> (<em>int</em>) &#8211; number of non-uniform samples.</li>
<li><strong>n</strong> (<em>int, tuple of int</em>) &#8211; oversampled multi-bandwith, default to 2 * N.</li>
<li><strong>m</strong> (<em>int</em>) &#8211; Cut-off parameter of the window function.</li>
<li><strong>x</strong> (<em>ndarray</em>) &#8211; external array holding the nodes.</li>
<li><strong>f</strong> (<em>ndarray</em>) &#8211; external array holding the non-uniform samples.</li>
<li><strong>f_hat</strong> (<em>ndarray</em>) &#8211; external array holding the Fourier coefficients.</li>
<li><strong>flags</strong> (<em>tuple</em>) &#8211; list of precomputation flags, see note below.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>Precomputation flags</strong></p>
<p>This table lists the supported precomputation flags for the NFFT.</p>
<table border="1" class="docutils">
<colgroup>
<col width="36%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Flag</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>PRE_PHI_HUT</td>
<td>Precompute the roll-off correction coefficients.</td>
</tr>
<tr class="row-odd"><td>FG_PSI</td>
<td>Convolution uses Fast Gaussian properties.</td>
</tr>
<tr class="row-even"><td>PRE_LIN_PSI</td>
<td>Convolution uses a precomputed look-up table.</td>
</tr>
<tr class="row-odd"><td>PRE_FG_PSI</td>
<td>Precompute Fast Gaussian.</td>
</tr>
<tr class="row-even"><td>PRE_PSI</td>
<td>Standard precomputation, uses M*(2m+2)*d values.</td>
</tr>
<tr class="row-odd"><td>PRE_FULL_PSI</td>
<td>Full precomputation, uses M*(2m+2)^d values.</td>
</tr>
</tbody>
</table>
<p>Default value is <tt class="docutils literal"><span class="pre">flags</span> <span class="pre">=</span> <span class="pre">('PRE_PHI_HUT',</span> <span class="pre">'PRE_PSI')</span></tt>.</p>
<dl class="attribute">
<dt id="pynfft.NFFT.d">
<tt class="descname">d</tt><a class="headerlink" href="#pynfft.NFFT.d" title="Permalink to this definition">¶</a></dt>
<dd><p>The dimensionality of the NFFT.</p>
</dd></dl>

<dl class="attribute">
<dt id="pynfft.NFFT.N">
<tt class="descname">N</tt><a class="headerlink" href="#pynfft.NFFT.N" title="Permalink to this definition">¶</a></dt>
<dd><p>The multi-bandwith size.</p>
</dd></dl>

<dl class="attribute">
<dt id="pynfft.NFFT.N_total">
<tt class="descname">N_total</tt><a class="headerlink" href="#pynfft.NFFT.N_total" title="Permalink to this definition">¶</a></dt>
<dd><p>The total number of Fourier coefficients.</p>
</dd></dl>

<dl class="attribute">
<dt id="pynfft.NFFT.M_total">
<tt class="descname">M_total</tt><a class="headerlink" href="#pynfft.NFFT.M_total" title="Permalink to this definition">¶</a></dt>
<dd><p>The total number of samples.</p>
</dd></dl>

<dl class="attribute">
<dt id="pynfft.NFFT.m">
<tt class="descname">m</tt><a class="headerlink" href="#pynfft.NFFT.m" title="Permalink to this definition">¶</a></dt>
<dd><p>The cut-off parameter of the window function.</p>
</dd></dl>

<dl class="attribute">
<dt id="pynfft.NFFT.n">
<tt class="descname">n</tt><a class="headerlink" href="#pynfft.NFFT.n" title="Permalink to this definition">¶</a></dt>
<dd><p>The oversampled multi-bandwith size.</p>
</dd></dl>

<dl class="attribute">
<dt id="pynfft.NFFT.x">
<tt class="descname">x</tt><a class="headerlink" href="#pynfft.NFFT.x" title="Permalink to this definition">¶</a></dt>
<dd><p>The nodes in time/spatial domain.</p>
</dd></dl>

<dl class="attribute">
<dt id="pynfft.NFFT.f">
<tt class="descname">f</tt><a class="headerlink" href="#pynfft.NFFT.f" title="Permalink to this definition">¶</a></dt>
<dd><p>The vector of non-uniform samples.</p>
</dd></dl>

<dl class="attribute">
<dt id="pynfft.NFFT.f_hat">
<tt class="descname">f_hat</tt><a class="headerlink" href="#pynfft.NFFT.f_hat" title="Permalink to this definition">¶</a></dt>
<dd><p>The vector of Fourier coefficients.</p>
</dd></dl>

<dl class="attribute">
<dt id="pynfft.NFFT.dtype">
<tt class="descname">dtype</tt><a class="headerlink" href="#pynfft.NFFT.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>The floating precision.</p>
</dd></dl>

<dl class="attribute">
<dt id="pynfft.NFFT.flags">
<tt class="descname">flags</tt><a class="headerlink" href="#pynfft.NFFT.flags" title="Permalink to this definition">¶</a></dt>
<dd><p>The precomputation flags.</p>
</dd></dl>

<dl class="method">
<dt id="pynfft.NFFT.precompute">
<tt class="descname">precompute</tt><big>(</big><big>)</big><a class="headerlink" href="#pynfft.NFFT.precompute" title="Permalink to this definition">¶</a></dt>
<dd><p>Precomputes the NFFT plan internals.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The nodes <a class="reference internal" href="#pynfft.NFFT.x" title="pynfft.NFFT.x"><tt class="xref py py-attr docutils literal"><span class="pre">pynfft.NFFT.x</span></tt></a> must be initialized before
precomputing.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pynfft.NFFT.trafo">
<tt class="descname">trafo</tt><big>(</big><big>)</big><a class="headerlink" href="#pynfft.NFFT.trafo" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the forward NFFT.</p>
<p>Reads <a class="reference internal" href="#pynfft.NFFT.f_hat" title="pynfft.NFFT.f_hat"><tt class="xref py py-attr docutils literal"><span class="pre">pynfft.NFFT.f_hat</span></tt></a> and stores the result in
<a class="reference internal" href="#pynfft.NFFT.f" title="pynfft.NFFT.f"><tt class="xref py py-attr docutils literal"><span class="pre">pynfft.NFFT.f</span></tt></a>.</p>
</dd></dl>

<dl class="method">
<dt id="pynfft.NFFT.trafo_direct">
<tt class="descname">trafo_direct</tt><big>(</big><big>)</big><a class="headerlink" href="#pynfft.NFFT.trafo_direct" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the forward NDFT.</p>
<p>Reads <a class="reference internal" href="#pynfft.NFFT.f_hat" title="pynfft.NFFT.f_hat"><tt class="xref py py-attr docutils literal"><span class="pre">pynfft.NFFT.f_hat</span></tt></a> and stores the result in
<a class="reference internal" href="#pynfft.NFFT.f" title="pynfft.NFFT.f"><tt class="xref py py-attr docutils literal"><span class="pre">pynfft.NFFT.f</span></tt></a>.</p>
</dd></dl>

<dl class="method">
<dt id="pynfft.NFFT.adjoint">
<tt class="descname">adjoint</tt><big>(</big><big>)</big><a class="headerlink" href="#pynfft.NFFT.adjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the adjoint NFFT.</p>
<p>Reads <a class="reference internal" href="#pynfft.NFFT.f" title="pynfft.NFFT.f"><tt class="xref py py-attr docutils literal"><span class="pre">pynfft.NFFT.f</span></tt></a> and stores the result in
<a class="reference internal" href="#pynfft.NFFT.f_hat" title="pynfft.NFFT.f_hat"><tt class="xref py py-attr docutils literal"><span class="pre">pynfft.NFFT.f_hat</span></tt></a>.</p>
</dd></dl>

<dl class="method">
<dt id="pynfft.NFFT.adjoint_direct">
<tt class="descname">adjoint_direct</tt><big>(</big><big>)</big><a class="headerlink" href="#pynfft.NFFT.adjoint_direct" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the adjoint NDFT.</p>
<p>Reads <a class="reference internal" href="#pynfft.NFFT.f" title="pynfft.NFFT.f"><tt class="xref py py-attr docutils literal"><span class="pre">pynfft.NFFT.f</span></tt></a> and stores the result in
<a class="reference internal" href="#pynfft.NFFT.f_hat" title="pynfft.NFFT.f_hat"><tt class="xref py py-attr docutils literal"><span class="pre">pynfft.NFFT.f_hat</span></tt></a>.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="solver-class">
<h2>Solver Class<a class="headerlink" href="#solver-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pynfft.Solver">
<em class="property">class </em><tt class="descclassname">pynfft.</tt><tt class="descname">Solver</tt><big>(</big><em>nfft_plan</em>, <em>flags=None</em><big>)</big><a class="headerlink" href="#pynfft.Solver" title="Permalink to this definition">¶</a></dt>
<dd><p>Solver is a class for computing the adjoint NFFT iteratively. Using the
solver should theoretically lead to more accurate results, even with just
one iteration, than using <a class="reference internal" href="#pynfft.NFFT.adjoint" title="pynfft.NFFT.adjoint"><tt class="xref py py-meth docutils literal"><span class="pre">pynfft.NFFT.adjoint()</span></tt></a> or
<a class="reference internal" href="#pynfft.NFFT.adjoint_direct" title="pynfft.NFFT.adjoint_direct"><tt class="xref py py-meth docutils literal"><span class="pre">pynfft.NFFT.adjoint_direct()</span></tt></a>.</p>
<p>The instantiation requires a NFFT object used internally for the multiple
forward and adjoint NFFT performed. The class uses conjugate-gradient as
the default solver but alternative solvers can be specified.</p>
<p>Because the stopping conidition of the iterative computation may change
from one application to another, the implementation only let you carry
one iteration at a time with a call to
<a class="reference internal" href="#pynfft.Solver.loop_one_step" title="pynfft.Solver.loop_one_step"><tt class="xref py py-meth docutils literal"><span class="pre">pynfft.Solver.loop_one_step()</span></tt></a>. Initialization of the solver
is done by calling the <a class="reference internal" href="#pynfft.Solver.before_loop" title="pynfft.Solver.before_loop"><tt class="xref py py-meth docutils literal"><span class="pre">pynfft.Solver.before_loop()</span></tt></a> method.</p>
<p>The class exposes the internals of the solver through call to their
respective properties. They should be treated as read-only values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>plan</strong> (<a class="reference internal" href="#pynfft.NFFT" title="pynfft.NFFT"><tt class="xref py py-class docutils literal"><span class="pre">pynfft.NFFT</span></tt></a>) &#8211; instance of NFFT.</li>
<li><strong>flags</strong> (<em>tuple</em>) &#8211; list of instantiation flags, see below.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>Instantiation flags</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="79%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Flag</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>LANDWEBER</td>
<td>Use Landweber (Richardson) iteration.</td>
</tr>
<tr class="row-odd"><td>STEEPEST_DESCENT</td>
<td>Use steepest descent iteration.</td>
</tr>
<tr class="row-even"><td>CGNR</td>
<td>Use conjugate gradient (normal equation of the 1st kind).</td>
</tr>
<tr class="row-odd"><td>CGNE</td>
<td>Use conjugate gradient (normal equation of the 2nd kind).</td>
</tr>
<tr class="row-even"><td>NORMS_FOR_LANDWEBER</td>
<td>Use Landweber iteration to compute the residual norm.</td>
</tr>
<tr class="row-odd"><td>PRECOMPUTE_WEIGHT</td>
<td>Weight the samples, e.g. to cope with varying sampling density.</td>
</tr>
<tr class="row-even"><td>PRECOMPUTE_DAMP</td>
<td>Weight the Fourier coefficients, e.g. to favour fast decaying coefficients.</td>
</tr>
</tbody>
</table>
<p>Default value is <tt class="docutils literal"><span class="pre">flags</span> <span class="pre">=</span> <span class="pre">('CGNR',)</span></tt>.</p>
<dl class="attribute">
<dt id="pynfft.Solver.w">
<tt class="descname">w</tt><a class="headerlink" href="#pynfft.Solver.w" title="Permalink to this definition">¶</a></dt>
<dd><p>Weighting factors.</p>
</dd></dl>

<dl class="attribute">
<dt id="pynfft.Solver.w_hat">
<tt class="descname">w_hat</tt><a class="headerlink" href="#pynfft.Solver.w_hat" title="Permalink to this definition">¶</a></dt>
<dd><p>Damping factors.</p>
</dd></dl>

<dl class="attribute">
<dt id="pynfft.Solver.y">
<tt class="descname">y</tt><a class="headerlink" href="#pynfft.Solver.y" title="Permalink to this definition">¶</a></dt>
<dd><p>Right hand side, samples.</p>
</dd></dl>

<dl class="attribute">
<dt id="pynfft.Solver.f_hat_iter">
<tt class="descname">f_hat_iter</tt><a class="headerlink" href="#pynfft.Solver.f_hat_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterative solution.</p>
</dd></dl>

<dl class="attribute">
<dt id="pynfft.Solver.r_iter">
<tt class="descname">r_iter</tt><a class="headerlink" href="#pynfft.Solver.r_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Residual vector.</p>
</dd></dl>

<dl class="attribute">
<dt id="pynfft.Solver.dtype">
<tt class="descname">dtype</tt><a class="headerlink" href="#pynfft.Solver.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>The floating precision.</p>
</dd></dl>

<dl class="attribute">
<dt id="pynfft.Solver.flags">
<tt class="descname">flags</tt><a class="headerlink" href="#pynfft.Solver.flags" title="Permalink to this definition">¶</a></dt>
<dd><p>The precomputation flags.</p>
</dd></dl>

<dl class="method">
<dt id="pynfft.Solver.before_loop">
<tt class="descname">before_loop</tt><big>(</big><big>)</big><a class="headerlink" href="#pynfft.Solver.before_loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize solver internals.</p>
</dd></dl>

<dl class="method">
<dt id="pynfft.Solver.loop_one_step">
<tt class="descname">loop_one_step</tt><big>(</big><big>)</big><a class="headerlink" href="#pynfft.Solver.loop_one_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform one iteration.</p>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#"><tt class="docutils literal"><span class="pre">pynfft</span></tt> - The core NFFT functionalities</a><ul>
<li><a class="reference internal" href="#nfft-class">NFFT Class</a></li>
<li><a class="reference internal" href="#solver-class">Solver Class</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../api.html"
                        title="previous chapter">API Reference</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="util.html"
                        title="next chapter"><tt class="docutils literal"><span class="pre">pynfft.util</span></tt> - Utility functions</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/api/nfft.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="util.html" title="pynfft.util - Utility functions"
             >next</a> |</li>
        <li class="right" >
          <a href="../api.html" title="API Reference"
             >previous</a> |</li>
        <li><a href="../index.html">pyNFFT 1.0.0 documentation</a> &raquo;</li>
          <li><a href="../api.html" >API Reference</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Ghislain Vaillant.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>